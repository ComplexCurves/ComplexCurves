<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Complex Curves</title>
<link rel="shortcut icon" href="examples/favicon.ico" />
<script type="text/javascript" src="http://oss.maxcdn.com/jquery/2.2.2/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="http://oss.maxcdn.com/semantic-ui/2.1.8/semantic.min.css" />
<script type="text/javascript" src="http://oss.maxcdn.com/semantic-ui/2.1.8/semantic.min.js"></script>
<script type="text/javascript" src="build/SingularityExplorer.js"></script>
<script type="text/javascript">
var examples, results, oldvalue;

function appendExample(curves, example, interactive = false) {
    var curve = document.createElement("div");
    curve.id = example.id;
    curve.setAttribute("class", "ui card");
    if (interactive) {
        if (example.cached) {
            var iframe = document.createElement("iframe");
            iframe.src = "examples/" + example.id + ".cached.html";
            iframe.width = 450;
            iframe.height = 450;
            iframe.scrolling = "no";
            iframe.setAttribute("frameborder", "0");
            curve.appendChild(iframe);
        } else {
            var canvas = document.createElement('canvas');
            canvas.width = 800;
            canvas.height = 800;
            //canvas.style.width = "450px";
            //canvas.style.height = "450px";
            curve.appendChild(canvas);
            canvas.singularityExplorer =
                SingularityExplorer.fromEquation(canvas, example.equation,
                    example.depth || 12);
        }
    } else {
        //var imgContainer = document.createElement("div");
        //imgContainer.setAttribute("class", "ui medium image");
        var img = document.createElement("img");
        img.setAttribute("class", "ui medium image");
        img.src = "examples/" + example.id + ".png";
        //imgContainer.appendChild(img);
        //curve.appendChild(imgContainer);
        curve.appendChild(img);
    }
    var contentContainer = document.createElement("div");
    contentContainer.setAttribute("class", "content");
    if (example.name) {
        var p = document.createElement("p");
        p.setAttribute("class", "header");
        p.innerHTML = example.name;
        contentContainer.appendChild(p);
    }
    if (example.equation) {
        var descriptionContainer = document.createElement("div");
        descriptionContainer.setAttribute("class", "description");
        descriptionContainer.innerHTML = "\\[" + example.equation + "=0\\]";
        contentContainer.appendChild(descriptionContainer);
    }
    curve.appendChild(contentContainer);
    curves.appendChild(curve);
}

function clearExamples(curves) {
    var canvas = curves.querySelector("canvas");
    if (canvas)
        canvas.singularityExplorer.unregisterEventHandlers();
    while (curves.hasChildNodes())
        curves.removeChild(curves.firstChild);
}

function showExample(example) {
    if (example !== null) {
        var curves = document.getElementById("curves");
        clearExamples(curves);
        appendExample(curves, example, true);
    }
}

function showExamples(examples) {
    if (examples !== null) {
        var curves = document.getElementById("curves");
        clearExamples(curves);
        for (var i = 0; i < examples.length; i++)
            appendExample(curves, examples[i]);
    }
}

document.addEventListener("DOMContentLoaded", function() {
    var req = new XMLHttpRequest();
    req.open("GET", "examples.json");
    req.responseType = "json";
    req.onload = function() {
        examples = req.response;
        showExamples(examples);
    };
    req.send();

    var search = document.querySelector("input[type=search]");
    oldvalue = search.value.toLowerCase();
    search.addEventListener("keydown", function(evt) {
        evt.stopPropagation();
    });
    search.addEventListener("keyup", function(evt) {
        var value = search.value.toLowerCase();
        if (value === oldvalue)
            return;
        oldvalue = value;
        results = examples;
        if (value.length > 0) {
            results = examples.filter(function(example) {
                return example.name.toLowerCase().startsWith(value);
            });
            results = results.concat(examples.filter(function(example) {
                var name = example.name.toLowerCase();
                return !name.startsWith(value) && name.includes(value);
            }));
        }
        showExamples(results);
        evt.stopPropagation();
    });

	/*
    var form = document.querySelector("#container form");
    form.addEventListener("submit", function(evt) {
        evt.preventDefault();
        showExample(results[0] || {
            "id": "CustomEquation",
            "equation": search.value
        });
    });
	*/
});
</script>
</head>
<body class="basic minimal">
<div class="main ui container">
<div class="ui search" style="margin: 1.75em 0">
	<div class="ui icon input">
		<input class="prompt" placeholder="Name or equation of curve" type="search">
		<i class="search icon"></i>
	</div>
	<div class="results"></div>
</div>
<div id="curves" class="ui four cards"></div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  "HTML-CSS": {availableFonts: ["TeX"]},
         MMLorHTML: {prefer: "HTML"}
});
MathJax.Hub.Register.StartupHook("HTML-CSS Jax Ready",function () {
  var VARIANT = MathJax.OutputJax["HTML-CSS"].FONTDATA.VARIANT;
  VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
  VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
  VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
  VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
});
MathJax.Hub.Register.StartupHook("SVG Jax Ready",function () {
  var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;
  VARIANT["normal"].fonts.unshift("MathJax_SansSerif");
  VARIANT["bold"].fonts.unshift("MathJax_SansSerif-bold");
  VARIANT["italic"].fonts.unshift("MathJax_SansSerif-italic");
  VARIANT["-tex-mathit"].fonts.unshift("MathJax_SansSerif-italic");
});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
